<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://www.kryogenix.org/code/browser/sorttable/sorttable.js"></script>
        
          <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script> -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        
        
        <style>
        body{
          background-color: #b8b4b3;
        }
        
        table {
          font-family: arial, sans-serif;
          border-collapse: collapse;
          width: 100%;
        }
        
        td, th {
          border: 1px solid #dddddd;
          text-align: left;
          padding: 8px;
        }
        
        tr:nth-child(even) {
          background-color: #dddddd;
        }</style>
    </head>
    <body>
       

<!-- ====================================modal================================================= -->

<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" >Todo List</a>
    </div>
    <ul class="nav navbar-nav">
      <li><a  data-toggle="modal" data-target="#exampleModal">Add Catagory</a></li>
      <li><a href="#" data-toggle="modal" data-target="#exampleModal1">Add Task</a></li>
      <li><a><input id="myInput" class="" style="width: 500px; color: black;" type="text" placeholder="Search.."></a></li>
      <li><a style="position:initial;" onclick="sortTable()">Sort by date</a></li>
      <li><a>Task Count : {{count}}</a></li>
      <li><a href="{{url_for('logout')}}">Logout</a></li>
    </ul>
  </div>
</nav>
  
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Add Category</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <form action="{{url_for('addcategory')}}" method="post">
        <div class="modal-body">
          <input type="text" name="cat" class="form-control" id="" placeholder="Add Catagory">
        </div>
        <div class="modal-footer">
            <input type="submit" class="btn btn-primary" value="Save">
        </form>
        </div>
      </div>
    </div>
  </div>

<!-- ================================================================================================ -->

  <!-- Modal -->
  <div class="modal fade" id="exampleModal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Add Task</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <form action="{{url_for('addtask')}}" method="post">
        <div class="modal-body">
          <input type="text" name="task_title" class="form-control" id="" placeholder="Add Task Title">
          <select name="cat_id" class="form-select" id="">
                {%for i in cat%}
                <option value="{{i.id}}">{{i.category_name}}</option>
                {%endfor%}
          </select>
          <input type="text" name="task_dis" class="form-control" id="" placeholder="Task description">
          <input type="date" name="date" class="form-control" id="" placeholder="date">
        </div>
        <div class="modal-footer">
            <input type="submit" class="btn btn-primary" value="Save">
        </form>
        </div>
      </div>
    </div>
  </div>

  
  <div class="container" style="margin-top: 50px;">
    {%if task %}
    <table class="sortable table" id="myTable1" border="2">
      <thead >
        <tr>
          <th >Task Title</th>
          <th>Task Discription</th>
          <th>Task Category</th>
          <th>Task date</th>
          <th>status</th>
        </tr>
      </thead>
  
  {% for i in task%}
      <tbody id="myTable">
        <tr class="item">
          <td>{{i.task_title}}</td>
          <td>{{i.task_dis}}</td>
          <td>
            
            {%for j in cat%}
              {%if j.id == i.cat_id%}
                  {{j.category_name}}
              {%endif%}
            {%endfor%}
        </td>
          <td>{{str(i.date).replace("00:00:00",'')}}  </td>


          {%if i.status == 'pending'%}
          <td><a class="btn btn-primary" href="{{url_for('done' ,id=i.id)}}">{{i.status}}</a></td>
          {%else%}
          <td><a>{{i.status}}</a></td>
          {%endif%}
        </tr>
      </tbody> 
    {%endfor%}
  </table>  
    {%else%}
    <h1>No tasks for you</h1>
  {%endif%}

</div>





<footer class="bg-body-tertiary text-center text-lg-start " style="margin-top: 200px;">
  <!-- Grid container -->
  
        <h5 class="text-uppercase">TODO LIST</h5>
          
          <!-- Copyright -->
  <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.05);">
    Â© 2024 Copyright:
    <a class="text-body" href="url_for('login')">todolist.com</a>
  </div>
  <!-- Copyright -->
</footer>
</body>
</html>

<script>
  $(document).ready(function(){
    $("#myInput").on("keyup", function() {
      var value = $(this).val().toLowerCase();
      $("#myTable tr").filter(function() {
        $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
      });
    });
  });
  </script>


<script>
  function sortTable() {
    var table, rows, switching, i, x, y, shouldSwitch;
    table = document.getElementById("myTable1");
    switching = true;
    while (switching) {
      switching = false;
      rows = table.rows;
      for (i = 1; i < (rows.length - 1); i++) {
        shouldSwitch = false;
        x = rows[i].getElementsByTagName("TD")[3];
        y = rows[i + 1].getElementsByTagName("TD")[3];
        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
          shouldSwitch = true;
          break;
        }
      }
      if (shouldSwitch) {
        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
        switching = true;
      }
    }
  }
  </script>